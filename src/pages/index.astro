---
// インポートセクション: Astroのコンポーネントや外部ライブラリをインポート
import appData from '../data/apps.json'; // 外部のJSONファイルからアプリデータをインポート
import { getCollection } from 'astro:content';

// ブログ記事を取得して日付順にソートし、最新の3件を取得
const allPosts = await getCollection('blog');
const sortedPosts = allPosts.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
const latestPosts = sortedPosts.slice(0, 3);

// appDataの構造はそのままなので、以降のテンプレート内のマップ処理は変更なし
const recentApps = appData.slice(0, 3);
---

<!-- Tailwind CSSを使用し、完全にレスポンシブな単一ページポートフォリオ -->
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio | モバイルアプリ開発</title>
</head>
<!-- ホワイト系配色を基調に設定 -->
<body class="bg-custom-bg text-custom-paragraph min-h-screen flex flex-col font-sans antialiased">

    <!-- 1. ヘッダー/ナビゲーション -->
    <!-- 1. ヘッダー/ナビゲーション (フローティング・ピルデザイン) -->
    <header class="fixed bottom-8 left-1/2 transform -translate-x-1/2 z-50 w-auto max-w-[90vw]">
        <nav class="bg-custom-headline/90 backdrop-blur-md text-custom-main px-6 py-3 rounded-full shadow-2xl border border-custom-secondary/20 flex items-center space-x-6">
            <!-- ルートリンク (アイコンのみ) -->
            <a href="/portfolio/" class="text-custom-highlight hover:text-white transition">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path></svg>
            </a>
            <div class="h-4 w-px bg-custom-secondary/30"></div>
            <div class="flex space-x-6 text-sm font-medium">
                <a href="/portfolio/#apps" class="hover:text-custom-highlight transition">Apps</a>
                <a href="/portfolio/blog" class="hover:text-custom-highlight transition">Blog</a>
                <a href="/portfolio/#about" class="hover:text-custom-highlight transition">About</a>
                <a href="/portfolio/#contact" class="hover:text-custom-highlight transition">Contact</a>
            </div>
        </nav>
    </header>

    <!-- 2. メインコンテンツ -->
    <main class="flex-grow">
        <!-- ヒーローセクション (ホワイトベースの配色に変更) -->
        <!-- ヒーローセクション (大胆なタイポグラフィとアニメーション) -->
        <section id="hero" class="min-h-[80vh] flex items-center justify-center py-20 bg-custom-bg relative overflow-hidden">
            <!-- 背景装飾 -->
            <div class="absolute top-0 left-0 w-full h-full overflow-hidden opacity-10 pointer-events-none">
                <div class="absolute top-1/4 left-1/4 w-64 h-64 bg-custom-highlight rounded-full mix-blend-multiply filter blur-3xl animate-float"></div>
                <div class="absolute bottom-1/4 right-1/4 w-96 h-96 bg-custom-secondary rounded-full mix-blend-multiply filter blur-3xl animate-float" style="animation-delay: 1s;"></div>
            </div>

            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center relative z-10">
                <span class="inline-block py-1 px-3 rounded-full bg-custom-secondary/30 text-custom-highlight text-sm font-semibold mb-6 animate-fade-in">
                    iOS Developer & UI Designer
                </span>
                <h1 class="text-6xl sm:text-8xl md:text-9xl font-black text-custom-headline leading-none tracking-tighter mb-8 animate-fade-in" style="animation-delay: 0.1s;">
                    CRAFTING<br>
                    <span class="text-transparent bg-clip-text bg-gradient-to-r from-custom-highlight to-custom-tertiary">DIGITAL</span><br>
                    EXPERIENCES
                </h1>
                <p class="mt-6 text-xl sm:text-2xl text-custom-paragraph max-w-2xl mx-auto animate-fade-in" style="animation-delay: 0.2s;">
                    使いやすさと美しさを兼ね備えた、<br class="hidden sm:block">心に残るモバイル体験を創造します。
                </p>
                <div class="mt-10 animate-fade-in" style="animation-delay: 0.3s;">
                    <a href="#apps" class="inline-flex items-center justify-center px-8 py-4 text-lg font-bold text-custom-main bg-custom-headline rounded-full hover:bg-custom-highlight transition transform hover:scale-105 duration-300 shadow-xl">
                        See My Work
                        <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"></path></svg>
                    </a>
                </div>
            </div>
        </section>

        <!-- 3. アプリ紹介セクション (Bento Grid) -->
        <section id="apps" class="py-24 bg-custom-bg">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex items-end justify-between mb-12">
                    <h2 class="text-5xl font-black text-custom-headline tracking-tight">
                        SELECTED<br>WORKS
                    </h2>
                    <a href="/portfolio/apps" class="hidden sm:inline-flex items-center text-custom-highlight font-bold hover:underline">
                        View All Apps
                        <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path></svg>
                    </a>
                </div>

                <!-- Bento Grid Layout -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 auto-rows-[minmax(300px,auto)]">
                    {recentApps.map((app, index) => (
                        <div class={`group relative bg-custom-main rounded-3xl p-8 border border-custom-secondary/50 hover:border-custom-highlight transition-all duration-500 hover:shadow-2xl overflow-hidden flex flex-col ${index === 0 ? 'md:col-span-2 md:row-span-2' : ''}`}>
                            <!-- 背景装飾 -->
                            <div class="absolute top-0 right-0 w-64 h-64 bg-custom-secondary/20 rounded-full blur-3xl -mr-32 -mt-32 transition group-hover:bg-custom-highlight/10"></div>
                            
                            <div class="relative z-10 flex-grow">
                                <div class="flex items-start justify-between mb-6">
                                    <img 
                                        src={app.iconPlaceholder} 
                                        alt={`${app.name} icon`}
                                        class="w-16 h-16 rounded-2xl shadow-md group-hover:scale-110 transition duration-500"
                                        onerror="this.src='https://placehold.co/64x64/dddddd/333333?text=APP';"
                                    />
                                    <a href={app.appStoreLink} target="_blank" class="p-2 bg-custom-bg rounded-full text-custom-headline hover:bg-custom-headline hover:text-custom-main transition">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg>
                                    </a>
                                </div>
                                
                                <h3 class={`font-bold text-custom-headline mb-3 ${index === 0 ? 'text-4xl' : 'text-2xl'}`}>
                                    {app.name}
                                </h3>
                                <p class="text-custom-paragraph text-lg line-clamp-3">
                                    {app.description}
                                </p>

                                {index === 0 && app.images && app.images.length > 0 && (
                                    <div class="mt-6 grid grid-cols-2 gap-4">
                                        {app.images.slice(0, 4).map((image) => (
                                            <img 
                                                src={image} 
                                                alt={`${app.name} screenshot`} 
                                                class="rounded-xl shadow-sm border border-custom-secondary/30 hover:scale-105 transition duration-300 object-cover w-full h-32 sm:h-48"
                                            />
                                        ))}
                                    </div>
                                )}
                            </div>

                            <div class="relative z-10 mt-8 pt-6 border-t border-custom-secondary/30">
                                <ul class="flex flex-wrap gap-2">
                                    {app.features.slice(0, index === 0 ? 4 : 2).map((feature) => (
                                        <li class="text-xs font-medium px-3 py-1 rounded-full bg-custom-secondary/30 text-custom-headline">
                                            {feature}
                                        </li>
                                    ))}
                                </ul>
                            </div>
                        </div>
                    ))}
                </div>
                
                <div class="mt-8 text-center sm:hidden">
                    <a href="/portfolio/apps" class="inline-flex items-center text-custom-highlight font-bold hover:underline">
                        View All Apps
                        <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path></svg>
                    </a>
                </div>
            </div>
        </section>

        <!-- 最新のブログ記事セクション (Minimal List) -->
        <section id="latest-blog" class="py-24 bg-custom-main border-t border-custom-secondary/30">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex items-end justify-between mb-12">
                    <h2 class="text-5xl font-black text-custom-headline tracking-tight">
                        LATEST<br>THOUGHTS
                    </h2>
                    <a href="/portfolio/blog" class="hidden sm:inline-flex items-center text-custom-highlight font-bold hover:underline">
                        Read All Posts
                        <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path></svg>
                    </a>
                </div>

                <div class="space-y-6">
                    {latestPosts.map((post) => (
                        <a href={`/portfolio/blog/${post.slug}`} class="group block">
                            <article class="flex flex-col md:flex-row md:items-center justify-between py-8 border-b border-custom-secondary/30 group-hover:border-custom-highlight transition">
                                <div class="md:w-3/4">
                                    <div class="flex items-center text-sm text-custom-paragraph mb-2">
                                        <time datetime={post.data.pubDate.toISOString()} class="font-mono">
                                            {post.data.pubDate.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}
                                        </time>
                                        {post.data.tags && post.data.tags.length > 0 && (
                                            <>
                                                <span class="mx-3 text-custom-secondary">/</span>
                                                <span class="font-medium text-custom-highlight">
                                                    {post.data.tags[0]}
                                                </span>
                                            </>
                                        )}
                                    </div>
                                    <h3 class="text-2xl md:text-3xl font-bold text-custom-headline group-hover:text-custom-highlight transition">
                                        {post.data.title}
                                    </h3>
                                </div>
                                <div class="mt-4 md:mt-0 md:w-1/4 flex justify-end opacity-0 group-hover:opacity-100 transform translate-x-[-10px] group-hover:translate-x-0 transition duration-300">
                                    <span class="inline-flex items-center text-custom-highlight font-bold">
                                        Read
                                        <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path></svg>
                                    </span>
                                </div>
                            </article>
                        </a>
                    ))}
                </div>

                <div class="mt-12 text-center sm:hidden">
                    <a href="/portfolio/blog" class="inline-flex items-center text-custom-highlight font-bold hover:underline">
                        Read All Posts
                        <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path></svg>
                    </a>
                </div>
            </div>
        </section>

        <!-- 4. その他の情報/お問い合わせセクション (Aboutセクションを追加) -->
        <section id="about" class="py-16 md:py-24 bg-custom-bg border-t border-b border-custom-secondary">
            <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
                <h2 class="text-3xl font-extrabold text-center text-custom-headline mb-8">
                    About
                </h2>
                <div class="text-lg text-custom-paragraph space-y-4">
                    <p>
                        個人開発者として、iOSアプリケーションの開発・運営を行っています。ユーザーの「あると便利」を形にすることを目標に、シンプルで使いやすいデザインと、安定した機能提供を心がけています。
                    </p>
                    <p>
                        Swift/SwiftUIを中心に開発を行っており、アプリケーションの企画から設計、リリース、継続的な改善までを一貫して担当しています。
                    </p>
                    <p>
                        アプリ開発に関する技術的な交流や、新しいプロジェクトへの協力など、お気軽にお声がけください。
                    </p>
                </div>
            </div>
        </section>

        <section id="contact" class="py-16 md:py-24 bg-custom-bg">
            <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
                <h2 class="text-3xl font-extrabold text-custom-headline mb-4">
                    お問い合わせ
                </h2>
                <p class="text-lg text-custom-paragraph mb-8">
                    プロジェクトの相談、技術的な質問、またはご意見など、お気軽にご連絡ください。
                </p>
                <a 
                    href="mailto:contact@example.com" 
                    class="inline-block px-8 py-3 text-lg font-medium text-custom-button border-2 border-custom-button rounded-full hover:bg-custom-button hover:text-custom-button-text transition shadow-md"
                >
                    メールでのお問い合わせ (contact@example.com)
                </a>
            </div>
        </section>
    </main>

    <!-- 5. フッター -->
    <footer class="bg-custom-headline text-custom-main mt-auto">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 text-center text-sm">
            <p class="text-custom-secondary">&copy; {new Date().getFullYear()} All rights reserved.</p>
            <p class="mt-1 text-custom-secondary">Built with Astro and Tailwind CSS</p>
        </div>
    </footer>

</body>
</html>