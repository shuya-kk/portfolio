---
import { getCollection } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import BlogCard from "../../components/BlogCard.astro";
import SectionHeader from "../../components/SectionHeader.astro";

const allPosts = await getCollection("blog", ({ data }) => {
    return data.visibility === "public";
});
const sortedPosts = allPosts.sort(
    (a, b) => b.data.pubDate.getTime() - a.data.pubDate.getTime(),
);
---

<Layout title="ブログ">
    <div class="container-custom section-padding">
        <div class="max-w-3xl mb-24">
            <h1 class="heading-large mb-8">ブログ</h1>
            <p class="text-2xl text-secondary leading-relaxed font-medium">
                iOS開発の技術的な記録などをまとめています。
            </p>
        </div>

        <div
            class="bg-white border border-slate-50 rounded-[2rem] shadow-sm overflow-hidden divide-y divide-slate-50"
        >
            {
                sortedPosts.map((post) => (
                    <BlogCard
                        title={post.data.title}
                        date={post.data.pubDate}
                        slug={post.slug}
                        tags={post.data.tags}
                    />
                ))
            }
        </div>

        {
            sortedPosts.length === 0 && (
                <div class="text-center py-20 bg-surface border border-border rounded-xl mt-8">
                    <p class="text-secondary">記事が見つかりませんでした。</p>
                </div>
            )
        }
    </div>
</Layout>
