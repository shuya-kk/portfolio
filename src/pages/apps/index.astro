---
import appsData from "../../data/apps.json";
import Layout from "../../layouts/Layout.astro";
import AppCard from "../../components/AppCard.astro";
import SectionHeader from "../../components/SectionHeader.astro";

const apps = (appsData || []).sort((a: any, b: any) => {
    // First sort by rating count (popularity)
    const countDiff = (b.ratingCount || 0) - (a.ratingCount || 0);
    if (countDiff !== 0) return countDiff;
    // Then sort by rating value
    return (b.rating || 0) - (a.rating || 0);
});
---

<Layout title="制作実績">
    <div class="container-custom section-padding pt-40">
        <div class="max-w-3xl mb-24">
            <h1 class="heading-large mb-8">開発アプリ</h1>
            <p class="text-2xl text-secondary leading-relaxed font-medium">
                これまでに開発・リリースしたiOSアプリケーションの一覧です。
            </p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            {
                apps.map((app: any) => (
                    <AppCard
                        name={app.name}
                        description={app.description}
                        iconUrl={app.iconPlaceholder}
                        appStoreUrl={app.appStoreLink}
                        features={app.features}
                        isFeatured={false}
                        rating={app.rating}
                        ratingCount={app.ratingCount}
                    />
                ))
            }
        </div>
    </div>
</Layout>
